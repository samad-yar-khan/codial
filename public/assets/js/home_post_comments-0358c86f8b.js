let sucessFlash=function(e){new Noty({theme:"mint",text:e,type:"alert",layout:"topCenter",timeout:1500}).show()},errorFlash=function(e){new Noty({theme:"mint",text:"Post Created",type:"error",layout:"topCenter",timeout:1500}).show()};class PostComments{constructor(e){this.postId=e,this.postContainer=$("#post-"+e),this.newCommentsForm=$(`#post-${e}-comment-form`),this.createComment(e);let t=this;$(" .comments-delete-btn-link",this.postContainer).each((function(){t.deleteComment($(this))}))}createComment(e){let t=this;console.log("hey"),this.newCommentsForm.submit((function(n){n.preventDefault();console.log("SBMIT"),$.ajax({method:"POST",url:"/comments/create",data:$(this).serialize(),contentType:"application/x-www-form-urlencoded",success:function(n){console.log(e),console.log(n);let o=t.newCommentDom(n.data.commentData,n.data.post);$("#post-comments-"+e).prepend(o),t.deleteComment($(".comments-delete-btn-link",o)),sucessFlash(n.message),new ToggleLike($(" .like-btn-link",o))},error:function(e){console.log(e.error),errorFlash(e.message)}})}))}newCommentDom(e,t){return $(`\n        <li id=${e.Id}>\n        <h4>\n            ${e.User}\n        </h4>\n        <p class="comments-content">\n            ${e.Content}\n        </p>\n\n        <a href="/likes/toggle/?id=${e.Id}&type=Comment" class="like-btn-link" data-likes="${e.likes.length}">\n        <button class='like-btn' ><span id='like-count-${e.Id}-Comment'> ${e.likes.length}</span> &nbsp; <i class="fas fa-heart"></i></button>\n        </a>\n      \n        <a href="/comments/destroy/?commentId=${e.Id}&postAuthor=${t.user}" class="comments-delete-btn-link">\n            <button class="comments-delete-btn">Delete</button>\n        </a>\n     \n     </li>\n        `)}deleteComment(e){e.click((function(t){t.preventDefault(),$.ajax({method:"GET",url:$(e).prop("href"),success:function(e){$("#"+e.data.commentId).remove(),sucessFlash(e.message)},error:function(e){errorFlash(e.responseText)}})}))}}